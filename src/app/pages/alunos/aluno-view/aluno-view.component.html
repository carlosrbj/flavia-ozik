<div class="aluno-view" *ngIf="aluno">
  <!-- Cabeçalho do Aluno -->
  <div class="aluno-header">
    <div class="aluno-info">
      <div class="aluno-avatar">
        <i class="pi pi-user" *ngIf="!aluno.fotoUrl"></i>
        <img [src]="aluno.fotoUrl" *ngIf="aluno.fotoUrl" [alt]="aluno.nome" />
      </div>
      <div class="aluno-details">
        <h2>{{ aluno.nome }}</h2>
        <p class="aluno-status">
          <p-tag [value]="aluno.ativo ? 'Ativo' : 'Inativo'" 
                 [severity]="aluno.ativo ? 'success' : 'danger'"></p-tag>
          <span class="nivel">{{ aluno.nivel || 'Não informado' }}</span>
        </p>
        <p class="aluno-contact">
          <i class="pi pi-phone"></i> {{ aluno.telefone }}
          <i class="pi pi-envelope" *ngIf="aluno.email"></i> {{ aluno.email }}
        </p>
      </div>
    </div>
    
    <div class="aluno-actions">
      <button pButton icon="pi pi-pencil" label="Editar" 
              class="p-button-outlined" (click)="onEditar()"></button>
      <button pButton icon="pi pi-trash" label="Excluir" 
              class="p-button-outlined p-button-danger" (click)="onExcluir()"></button>
    </div>
  </div>

  <!-- Abas de Informações -->
  <p-tabView>
    
    <!-- Aba: Perfil -->
    <p-tabPanel header="Perfil" leftIcon="pi pi-user">
      <div class="tab-content">
        <div class="grid">
          <div class="col-12 md:col-6">
            <h4>Informações do Curso</h4>
            <div class="info-item">
              <label>Data de Início:</label>
              <span>{{ aluno.dataInicio | date:'dd/MM/yyyy' || 'Não informado' }}</span>
            </div>
            <div class="info-item">
              <label>Nível:</label>
              <span>{{ getNivelLabel(aluno.nivel) }}</span>
            </div>
            <div class="info-item">
              <label>Valor da Mensalidade:</label>
              <span>{{ aluno.valorMensalidade | currency:'BRL' || 'Não informado' }}</span>
            </div>
            <div class="info-item">
              <label>Forma de Pagamento:</label>
              <span>{{ getFormaPagamentoLabel(aluno.formaPagamento) }}</span>
            </div>
            <div class="info-item">
              <label>Dia do Vencimento:</label>
              <span>{{ aluno.diaVencimento || 'Não informado' }}</span>
            </div>
          </div>
          
          <div class="col-12 md:col-6">
            <h4>Observações</h4>
            <div class="info-item">
              <label>Observações Gerais:</label>
              <span>{{ aluno.observacoes || 'Nenhuma' }}</span>
            </div>
            <div class="info-item" *ngIf="!aluno.ativo">
              <label>Motivo da Inativação:</label>
              <span>{{ aluno.motivoInativo || 'Não informado' }}</span>
            </div>
          </div>
        </div>
      </div>
    </p-tabPanel>

    <!-- Aba: Financeiro -->
    <p-tabPanel header="Financeiro" leftIcon="pi pi-wallet">
      <div class="tab-content">
        <div class="grid">
          <div class="col-12 md:col-6">
            <div class="stat-card">
              <h5>Total de Mensalidades</h5>
              <p class="stat-value">{{ totalMensalidades }}</p>
            </div>
          </div>
          <div class="col-12 md:col-6">
            <div class="stat-card">
              <h5>Mensalidades Pagas</h5>
              <p class="stat-value">{{ mensalidadesPagas }}</p>
            </div>
          </div>
          <div class="col-12 md:col-6">
            <div class="stat-card">
              <h5>Mensalidades Atrasadas</h5>
              <p class="stat-value">{{ mensalidadesAtrasadas }}</p>
            </div>
          </div>
          <div class="col-12 md:col-6">
            <div class="stat-card">
              <h5>Total de Aulas</h5>
              <p class="stat-value">{{ totalAulas }}</p>
            </div>
          </div>
        </div>

        <div class="grid">
          <div class="col-12">
            <div class="action-card">
              <h4>Gestão Financeira</h4>
              <div class="action-buttons">
                <button pButton label="Pagamentos" icon="pi pi-dollar" 
                        class="p-button-outlined"></button>
                <button pButton label="Cobranças" icon="pi pi-bell" 
                        class="p-button-outlined"></button>
                <button pButton label="Relatórios" icon="pi pi-chart-bar" 
                        class="p-button-outlined"></button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </p-tabPanel>

    <!-- Aba Mensalidades -->
    <p-tabPanel header="Mensalidades">
      <div class="mensalidades-container">
        <div class="flex justify-content-between align-items-center mb-3">
          <h4 class="m-0">Histórico de Mensalidades</h4>
          <button pButton 
                  label="Gerar Nova Mensalidade" 
                  icon="pi pi-plus" 
                  class="p-button-outlined"
                  (click)="onGerarNovaMensalidade()">
          </button>
        </div>
        
        <p-table [value]="mensalidades" [paginator]="true" [rows]="5" responsiveLayout="scroll">
          <ng-template pTemplate="header">
            <tr>
              <th>Mês/Ano</th>
              <th>Valor</th>
              <th>Desconto</th>
              <th>Vencimento</th>
              <th>Status</th>
              <th>Ações</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-mensalidade>
            <tr>
              <td>{{ mensalidade.mes }}/{{ mensalidade.ano }}</td>
              <td>{{ mensalidade.valor | currency:'BRL' }}</td>
              <td>{{ mensalidade.desconto | currency:'BRL' }}</td>
              <td>{{ mensalidade.vencimento | date:'dd/MM/yyyy' }}</td>
              <td>
                <p-tag [value]="getStatusMensalidadeLabel(mensalidade.status)" 
                       [severity]="getStatusMensalidadeSeverity(mensalidade.status)">
                </p-tag>
              </td>
              <td>
                <button pButton icon="pi pi-eye" class="p-button-text" 
                        (click)="visualizarMensalidade(mensalidade)" 
                        pTooltip="Visualizar" tooltipPosition="bottom">
                </button>
                <button pButton icon="pi pi-pencil" class="p-button-text" 
                        (click)="editarMensalidade(mensalidade)" 
                        pTooltip="Editar" tooltipPosition="bottom">
                </button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </p-tabPanel>

    <!-- Aba Aulas -->
    <p-tabPanel header="Aulas">
      <div class="aulas-container">
        <div class="flex justify-content-between align-items-center mb-3">
          <h4 class="m-0">Histórico de Aulas</h4>
          <button pButton 
                  label="Agendar Nova Aula" 
                  icon="pi pi-plus" 
                  class="p-button-outlined"
                  (click)="onAgendarNovaAula()">
          </button>
        </div>
        
        <p-table [value]="aulas" [paginator]="true" [rows]="5" responsiveLayout="scroll">
          <ng-template pTemplate="header">
            <tr>
              <th>Data</th>
              <th>Horário</th>
              <th>Duração</th>
              <th>Conteúdo</th>
              <th>Presença</th>
              <th>Ações</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-aula>
            <tr>
              <td>{{ aula.data | date:'dd/MM/yyyy' }}</td>
              <td>{{ aula.horario }}</td>
              <td>{{ aula.duracao }}h</td>
              <td>{{ aula.conteudo }}</td>
              <td>
                <p-tag [value]="getPresencaLabel(aula.presenca)" 
                       [severity]="getPresencaSeverity(aula.presenca)">
                </p-tag>
              </td>
              <td>
                <button pButton icon="pi pi-eye" class="p-button-text" 
                        (click)="visualizarAula(aula)" 
                        pTooltip="Visualizar" tooltipPosition="bottom">
                </button>
                <button pButton icon="pi pi-pencil" class="p-button-text" 
                        (click)="editarAula(aula)" 
                        pTooltip="Editar" tooltipPosition="bottom">
                </button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </p-tabPanel>

    <!-- Aba Queimas -->
    <p-tabPanel header="Queimas">
      <div class="queimas-container">
        <div class="flex justify-content-between align-items-center mb-3">
          <h4 class="m-0">Histórico de Queimas</h4>
          <button pButton 
                  label="Agendar Nova Queima" 
                  icon="pi pi-plus" 
                  class="p-button-outlined"
                  (click)="onAgendarNovaQueima()">
          </button>
        </div>
        
        <p-table [value]="queimas" [paginator]="true" [rows]="5" responsiveLayout="scroll">
          <ng-template pTemplate="header">
            <tr>
              <th>Data</th>
              <th>Tipo</th>
              <th>Status</th>
              <th>Resultado</th>
              <th>Custo</th>
              <th>Ações</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-queima>
            <tr>
              <td>{{ queima.data | date:'dd/MM/yyyy' }}</td>
              <td>{{ queima.tipo }}</td>
              <td>
                <p-tag [value]="getStatusQueimaLabel(queima.status)" 
                       [severity]="getStatusQueimaSeverity(queima.status)">
                </p-tag>
              </td>
              <td>{{ queima.resultado || 'N/A' }}</td>
              <td>{{ queima.custo | currency:'BRL' }}</td>
              <td>
                <button pButton icon="pi pi-eye" class="p-button-text" 
                        (click)="visualizarQueima(queima)" 
                        pTooltip="Visualizar" tooltipPosition="bottom">
                </button>
                <button pButton icon="pi pi-pencil" class="p-button-text" 
                        (click)="editarQueima(queima)" 
                        pTooltip="Editar" tooltipPosition="bottom">
                </button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </p-tabPanel>

  </p-tabView>
</div>
